# Video2Text CLI (V2T)

ä¸€ä¸ªè½»é‡çº§çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºå°†è§†é¢‘è‡ªåŠ¨è½¬æ¢ä¸ºæ–‡å­—ç¨¿ã€‚æ”¯æŒ YouTubeã€Bilibili ç­‰ä¸»æµè§†é¢‘å¹³å°ï¼Œåˆ©ç”¨ OpenAI Whisper æ¨¡å‹åœ¨æœ¬åœ°è¿›è¡Œé«˜è´¨é‡è¯­éŸ³è½¬å†™ã€‚

## ğŸŒŸ ç‰¹æ€§

*   **å…¨è‡ªåŠ¨åŒ–**ï¼šä¸‹è½½ -> éŸ³é¢‘æå– -> AI è½¬å†™ -> å¯¼å‡ºæ–‡ç¨¿ï¼Œä¸€é”®å®Œæˆã€‚
*   **æœ¬åœ°éšç§**ï¼šä½¿ç”¨ `faster-whisper` åœ¨æœ¬åœ°è¿è¡Œæ¨¡å‹ï¼Œæ•°æ®ä¸ä¸Šä¼ äº‘ç«¯ã€‚
*   **åŒå¼•æ“æ”¯æŒ**ï¼š
    *   **Whisper** (é»˜è®¤)ï¼šé€šç”¨æ€§å¼ºï¼ŒOpenAI å‡ºå“ã€‚
    *   **FunASR (SenseVoice)**ï¼šé’ˆå¯¹ä¸­æ–‡ä¼˜åŒ–ï¼Œè¯†åˆ«å‡†ç¡®ç‡æé«˜ï¼Œé€Ÿåº¦å¿«ã€‚
*   **WebUI ç•Œé¢**ï¼šæä¾›å¯è§†åŒ–çš„ Web ç•Œé¢ï¼Œæ“ä½œæ›´ä¾¿æ·ã€‚
*   **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒå¯¼å‡º `.txt` çº¯æ–‡æœ¬å’Œ `.srt` å­—å¹•æ–‡ä»¶ã€‚
*   **Cookie æ”¯æŒ**ï¼šæ”¯æŒåŠ è½½ cookies.txt ä»¥ä¸‹è½½ä¼šå‘˜/å¹´é¾„é™åˆ¶è§†é¢‘ã€‚

## ğŸ› ï¸ å®‰è£…

### 1. å‰ç½®è¦æ±‚

*   Windows 10/11
*   Python 3.9+
*   FFmpeg (å¿…é¡»å®‰è£…)

æ¨èä½¿ç”¨ `winget` å®‰è£… FFmpeg:

```powershell
winget install ffmpeg
```

æˆ–è€…ä» [FFmpeg å®˜ç½‘](https://ffmpeg.org/download.html) ä¸‹è½½å¹¶æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ PATH ä¸­ã€‚

### 2. è·å–ä»£ç ä¸å®‰è£…ä¾èµ–

```bash
# å…‹éš†ä»“åº“ (å¦‚æœæ‚¨æœ‰ git) æˆ–ä¸‹è½½æºç 
git clone https://github.com/your-username/V2T.git
cd V2T

# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### âš¡ï¸ æ€§èƒ½ä¼˜åŒ–æŒ‡å—

ä¸ºäº†è·å¾—æœ€ä½³çš„è½¬å†™é€Ÿåº¦ï¼Œå»ºè®®æ ¹æ®æ‚¨çš„ç¡¬ä»¶é€‰æ‹©åˆé€‚çš„é…ç½®ï¼š

#### 1. Windows ç”¨æˆ· (NVIDIA GPU)
*   **æ¨èé…ç½®**ï¼š`--device cuda`
*   **å‰ææ¡ä»¶**ï¼š
    *   å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨ã€‚
    *   å®‰è£… CUDA Toolkit (æ¨è 11.8 æˆ– 12.x)ã€‚
    *   å®‰è£…æ”¯æŒ CUDA çš„ PyTorch ç‰ˆæœ¬ï¼ˆä»… FunASR éœ€è¦ï¼‰ã€‚
    *   å¯¹äº `faster-whisper`ï¼Œéœ€è¦ç¡®ä¿å®‰è£…äº† cuDNN åº“ï¼ˆé€šå¸¸åŒ…å«åœ¨ CUDA Toolkit ä¸­æˆ–å•ç‹¬å®‰è£…ï¼‰ã€‚
*   **å¦‚ä½•å¯ç”¨**ï¼š
    *   **å‘½ä»¤è¡Œ**ï¼šæ·»åŠ å‚æ•° `--device cuda`
    *   **WebUI**ï¼šåœ¨ "Device" é€‰é¡¹ä¸­é€‰æ‹© "cuda"ã€‚

#### 3. æ¨¡å‹é€‰æ‹©å»ºè®® (Whisper)
*   **tiny / base**: æå¿«ï¼Œé€‚åˆå¯¹ç²¾åº¦è¦æ±‚ä¸é«˜çš„åœºæ™¯ã€‚
*   **small**: é€Ÿåº¦ä¸ç²¾åº¦çš„å¹³è¡¡ç‚¹ï¼Œ**æ¨èæ—¥å¸¸ä½¿ç”¨**ã€‚
*   **medium**: ç²¾åº¦æ›´é«˜ï¼Œä½†åœ¨ CPU ä¸Šé€Ÿåº¦è¾ƒæ…¢ã€‚
*   **large-v3**: æœ€é«˜ç²¾åº¦ï¼Œå»ºè®®ä»…åœ¨æœ‰é«˜æ€§èƒ½ GPU æˆ–å¯¹æ—¶é—´ä¸æ•æ„Ÿæ—¶ä½¿ç”¨ã€‚

---

### ğŸ–¥ï¸ WebUI ç•Œé¢ (æ¨è)

å¦‚æœæ‚¨æ›´å–œæ¬¢å›¾å½¢ç•Œé¢ï¼Œå¯ä»¥ç›´æ¥å¯åŠ¨ WebUIï¼š

```bash
python webui.py
```

å¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®æ˜¾ç¤ºçš„æœ¬åœ°é“¾æ¥ï¼ˆé€šå¸¸æ˜¯ `http://127.0.0.1:7860`ï¼‰ã€‚

### ï¿½ ä½¿ç”¨ PM2 å®ˆæŠ¤è¿›ç¨‹ (ç”Ÿäº§ç¯å¢ƒæ¨è)

å¦‚éœ€é•¿æœŸè¿è¡Œ WebUI æœåŠ¡ï¼Œæ¨èä½¿ç”¨ PM2 è¿›è¡Œè¿›ç¨‹ç®¡ç†ï¼Œå®ç°è‡ªåŠ¨é‡å¯å’Œæ—¥å¿—ç®¡ç†ã€‚

#### 1. å®‰è£… PM2

```bash
npm install -g pm2
```

#### 2. ä½¿ç”¨ PM2 å¯åŠ¨æœåŠ¡

é¡¹ç›®å·²åŒ…å« `ecosystem.config.js` é…ç½®æ–‡ä»¶ï¼Œç›´æ¥è¿è¡Œï¼š

```bash
pm2 start ecosystem.config.js
```

#### 3. å¸¸ç”¨ PM2 å‘½ä»¤

| å‘½ä»¤ | åŠŸèƒ½ |
| :--- | :--- |
| `pm2 list` | æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çŠ¶æ€ |
| `pm2 logs v2t-webui` | æŸ¥çœ‹å®æ—¶æ—¥å¿— |
| `pm2 restart v2t-webui` | é‡å¯æœåŠ¡ |
| `pm2 stop v2t-webui` | åœæ­¢æœåŠ¡ |
| `pm2 delete v2t-webui` | åˆ é™¤è¿›ç¨‹ |
| `pm2 save` | ä¿å­˜å½“å‰è¿›ç¨‹åˆ—è¡¨ |
| `pm2 startup` | è®¾ç½®å¼€æœºè‡ªå¯ |

> **æ³¨æ„**ï¼šæ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ `./logs/` ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬ `webui-out.log` å’Œ `webui-error.log`ã€‚

### ï¿½ğŸ’» å‘½ä»¤è¡Œç”¨æ³•

### åŸºæœ¬ç”¨æ³•

ç›´æ¥è½¬æ¢å•ä¸ªè§†é¢‘ï¼š

```bash
python v2t.py "https://www.youtube.com/watch?v=dQw4w9WgXcQ"
```

### æ‰¹é‡å¤„ç†

åˆ›å»ºä¸€ä¸ªåŒ…å«å¤šä¸ªé“¾æ¥çš„æ–‡æœ¬æ–‡ä»¶ `urls.txt`ï¼š

```text
https://www.youtube.com/watch?v=video1
https://www.bilibili.com/video/BVxxx
```

ç„¶åè¿è¡Œï¼š

```bash
python v2t.py urls.txt
```

### å¸¸ç”¨å‚æ•°

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- |
| `urls` | è§†é¢‘é“¾æ¥æˆ–é“¾æ¥æ–‡ä»¶è·¯å¾„ | `python v2t.py url1 url2` |
| `--engine` | ASR å¼•æ“: `whisper` (é»˜è®¤) æˆ– `funasr` (SenseVoice) | `--engine funasr` |
| `--model` | Whisper æ¨¡å‹å¤§å° (tiny/base/small/medium/large-v3) | `--model large-v3` (é»˜è®¤ small) |
| `--language` | å¼ºåˆ¶æŒ‡å®šæºè¯­è¨€ä»£ç  | `--language zh` (é»˜è®¤è‡ªåŠ¨æ£€æµ‹) |
| `--task` | ä»»åŠ¡ç±»å‹: `transcribe`(è½¬å†™) æˆ– `translate`(ç¿»è¯‘ä¸ºè‹±æ–‡) | `--task translate` |
| `--output`, `-o` | è¾“å‡ºç›®å½• | `-o ./my_docs` |
| `--format` | è¾“å‡ºæ ¼å¼: `txt`, `srt`, `all` | `--format srt` |
| `--cookies` | æŒ‡å®š cookies.txt æ–‡ä»¶è·¯å¾„ | `--cookies ./cookies.txt` |
| `--keep-audio` | ä¿ç•™ä¸‹è½½çš„éŸ³é¢‘æ–‡ä»¶ (é»˜è®¤åˆ é™¤) | `--keep-audio` |

### é«˜çº§ç¤ºä¾‹

**ä½¿ç”¨ Large-v3 æ¨¡å‹å¹¶å¯¼å‡º SRT å­—å¹•ï¼š**

```bash
python v2t.py "https://youtu.be/xxx" --model large-v3 --format srt
```

**ä½¿ç”¨ Cookie ä¸‹è½½ä¼šå‘˜è§†é¢‘ï¼š**

å°†å¯¼å‡ºçš„ `cookies.txt` æ”¾åœ¨åŒçº§ç›®å½•ï¼Œæˆ–æ‰‹åŠ¨æŒ‡å®šï¼š

```bash
python v2t.py "https://www.bilibili.com/video/BVxxx" --cookies ./my_cookies.txt
```

## ğŸ“ æ³¨æ„äº‹é¡¹

*   **æ¨¡å‹ä¸‹è½½**ï¼šé¦–æ¬¡è¿è¡ŒæŸä¸ªæ¨¡å‹ï¼ˆå¦‚ `small`ï¼‰æ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨ä» Hugging Face ä¸‹è½½æ¨¡å‹æƒé‡ï¼Œè¯·ä¿æŒç½‘ç»œé€šç•…ã€‚
*   **æ–‡ä»¶å**ï¼šè¾“å‡ºæ–‡ä»¶åæ ¼å¼ä¸º `æ ‡é¢˜_è§†é¢‘ID`ï¼Œä¼šè‡ªåŠ¨å»é™¤éæ³•å­—ç¬¦ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License
